language: java
git:
  depth: false
jdk:
  - openjdk11
cache:
  directories:
    - "$HOME/.m2"
env:
  global:
  - USER="barnabegeffroy"
  - EMAIL="barnabe.geffroy@psl.eu"
  - REPO="receive_plaquette"
  - FILES="out.log out.pdf"
  - GH_REPO="github.com/${USER}/${REPO}.git"
  - secure: "put travis gem output here => http://docs.travis-ci.com/user/encryption-keys/"
script:
  - ruby test.rb
after_success:
  - MESSAGE=$(git log --format=%B -n 1 $TRAVIS_COMMIT)
  - git clone git://${GH_REPO}
  - mv -f ${FILES} ${REPO}
  - cd ${REPO}
  - git remote
  - git config user.email ${EMAIL}
  - git config user.name ${USER}
  - git add ${FILES}
  - git commit -m ${MESSAGE}
  - git push "https://${MY_DOC}@${GH_REPO}" master > /dev/null 2>&1
branches:
  only:
  - build

sudo: false

notifications:
  email: false